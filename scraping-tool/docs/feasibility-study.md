# スクレイピングツール実装可否の検討

**参照**: [10年住み替え前提の中古マンション購入条件（ドラフト）](../docs/10year-index-mansion-conditions-draft.md)

**規約確認結果**: [各サイトの利用規約確認結果](./terms-check.md) に、SUUMO / at home / HOME'S / REINS の規約とスクレイピング可否の整理あり。

---

## 1. 条件ドキュメントで求められる情報の整理

条件ドキュメントの「判定フロー」と Must/Prefer 条件から、ツールが扱うべき情報を**データソース別**に整理する。

| カテゴリ | 条件 | 必要となる情報 | 主なデータソース |
|----------|------|----------------|------------------|
| **立地** | 駅徒歩5分以内（上限10分） | 最寄駅・徒歩分数 | 物件サイト（一覧・詳細） |
| **立地** | 主要ターミナルへのアクセス | 駅名・路線・所要時間 | 物件サイト、乗換案内系 |
| **立地** | 賃貸需要も強い | 周辺相場・入居率等 | レポートサイト、別データ |
| **耐震・築年** | 新耐震（1981年6月以降） | 築年・竣工年 | 物件サイト |
| **耐震・築年** | Prefer: 築20年以内 | 築年 | 物件サイト |
| **管理・修繕** | 長期修繕計画がある | 計画の有無・内容 | 管理組合資料（非公開が多い） |
| **管理・修繕** | 修繕積立金が現実的 | 積立金・一時金計画 | 同上 |
| **管理・修繕** | 大規模修繕の実施・次回・積立残高 | 修繕履歴・残高 | 同上 |
| **管理・修繕** | Prefer: 管理計画認定制度 | 認定の有無 | 国交省サイト・物件サイト（記載ある場合） |
| **建物スケール** | 総戸数50戸以上（できれば100戸以上） | 総戸数 | 物件サイト（詳細に記載あり） |
| **売りやすい型** | 専有55〜75㎡、2LDK〜3LDK | 専有面積・間取り | 物件サイト |
| **成約・相場** | REINS成約で回転・価格推移を確認 | 成約価格・成約日・物件名 | REINS取引情報提供サイト |
| **マクロ・相場** | 国交省価格指数・東京カンテイ等 | 指数・レポート | 国交省・カンテイ等（参照用） |

---

## 2. データソース別の「スクレイピング／API利用」の可否

### 2.1 物件一覧・詳細（SUUMO / at home / HOME'S 等）

| 項目 | 可否 | 備考 |
|------|------|------|
| **スクレイピング** | ⚠️ 技術的には可能、利用規約要確認 | 公開APIなし。過度なアクセスは規約違反・ブロックのリスク。ポリシーに合わせた間隔・UAの配慮が前提。 |
| **取得しやすい項目** | ✅ 多数 | 駅徒歩・築年・専有面積・間取り・価格・総戸数・最寄駅・路線名 など。条件の一次フィルタに十分。 |
| **取得しづらい項目** | △ | 長期修繕計画の有無・積立金・管理計画認定は、詳細欄に「たまたま書いてある」場合は取れるが、原則は書類で確認する前提。 |

**結論（物件サイト）**  
- **一次フィルタ用のツールは実装可能**。  
- 駅徒歩・築年・専有面積・間取り・総戸数・価格帯で Must の大半を絞り込み、「候補20件」を拾う用途に使える。  
- 利用規約を確認したうえで、負荷を抑えた設計（リクエスト間隔、キャッシュ、必要なら利用止め時の代替手段）が必須。

---

### 2.2 REINS 取引価格情報（成約データ）

| 項目 | 可否 | 備考 |
|------|------|------|
| **個人の利用** | ✅ 可能 | 「不動産取引情報提供サイト（レインズマーケットインフォメーション）」`https://www.contract.reins.or.jp/` で、個人が無料検索できる。 |
| **スクレイピング／API** | ⚠️ 要確認 | 画面上の検索結果をスクレイピングすることは技術的には可能だが、利用規約・利用目的の制限の有無を確認する必要がある。 |
| **得られる情報** | ✅ 成約中心 | エリア・築年数・間取り・最寄駅・取引時期などで絞り込み、成約価格・成約時期の傾向を把握するのに使える。 |

**結論（REINS系）**  
- **成約データの取得は「サイトの利用規約次第」**。  
- 規約上許容されていれば、「同一・近傍マンションの成約推移」「回転の速さ」を補助するツールを実装することは可能。  
- 規約で禁止されている場合は、ツールでは「REINSは手動で確認する」前提とし、物件サイトで拾った候補リストをREINS検索に渡すフローにすると現実的。

---

### 2.3 管理・修繕（長期修繕計画・積立金・認定制度）

| 項目 | 可否 | 備考 |
|------|------|------|
| **長期修繕計画・積立金** | ❌ スクレイピングでは困難 | 管理組合の書類であり、物件サイトには載らないことが多い。中古の場合、購入検討時に売主・仲介から入手する前提。 |
| **管理計画認定** | △ 限定的 | 国交省の「マンション管理計画認定制度」一覧等にリストはあるが、物件と突き合わせるには別途データ整備が必要。物件詳細に「認定マンション」と記載があればその物件に限り取得可能。 |

**結論（管理・修繕）**  
- **管理・修繕に関する自動収集は、現実的には「補助的に拾える範囲にとどめる」**。  
- ツールの主目的は「書類で10件に絞る」**前段**の「候補20件を効率的に出す」こととし、管理書類の精査はフロー上は手動のままとするのが妥当。

---

### 2.4 マクロ・相場（国交省指数・東京カンテイ等）

| 項目 | 可否 | 備考 |
|------|------|------|
| **国交省 不動産価格指数** | △ 要確認 | 公開PDF・HTMLの取得は可能だが、利用規約・二次利用の可否を確認する必要がある。 |
| **東京カンテイ等のレポート** | △ 要確認 | 有料・会員制の部分が多く、スクレイピングの対象としてどう扱うかは各社規約に依存。 |

**結論（マクロ・相場）**  
- **ツールのコア機能にはせず、「参照用リンク」や「手動で見る前提」にして、まずは物件フィルタとREINS補助に集中する**のが安全。

---

## 3. 実装可否の総合評価

### 3.1 実装可能な範囲（推奨スコープ）

1. **物件サイトのスクレイピング（一次フィルタ用）**
   - 条件ドキュメントの次の Must を、一覧・詳細から機械的に絞り込む：
     - 駅徒歩5分以内（上限10分）
     - 新耐震（1982年以降竣工を目安にした築年フィルタ）
     - 専有面積 55〜75㎡
     - 間取り 2LDK〜3LDK
     - 総戸数 50戸以上
     - 価格帯 7,500万〜1億（必要なら変更可能なパラメータ）
   - 対象サイト：SUUMO / at home / HOME'S のいずれか、または複数（規約確認のうえ）。
   - 出力例：条件を満たす物件のリスト（URL・主要項目・簡単なスコア）をCSVやJSONで保存し、「候補20件」を素早く拾えるようにする。

2. **REINS 取引情報の補助利用（規約確認後）**
   - 規約で認められていれば、指定エリア・築年・間取り等で成約傾向を取得し、「回転の速さ」「価格推移」の参考データをツール側で表示する。  
   - 認められていなければ、**物件ツールの出力（候補マンション名・駅・築年）を、REINSの検索条件として手動入力するためのチェックリスト**として使う。

3. **判定フローとの対応**
   - 条件ドキュメントの「1. 物件候補を20件拾う」を自動化する部分をツールが担当する。
   - 「2. 管理書類で10件に絞る」「3. REINS成約で最終3件」「4. 内見」は、ツールの出力を入力にした**手動フロー**として残す。

### 3.2 実装が難しい／見送る方がよい範囲

- **長期修繕計画・積立金・大規模修繕履歴の自動取得**  
  → データが物件サイトに揃っておらず、スクレイピングで実装するのは現実的でない。  
- **賃貸需要の定量的な自動判定**  
  → 別データ・別サービスが必要で、スコープが大きくなりがち。  
- **国交省指数・東京カンテイ等の自動取り込み**  
  → 規約・利用形態の確認が重いため、初版ではリンク集・手動参照に留める。

### 3.3 技術的な注意点

- **利用規約の確認**  
  SUUMO / at home / HOME'S / REINS取引情報サイトの利用規約と、爬虫行為・商業利用の可否を必ず確認する。  
- **負荷対策**  
  リクエスト間隔（例：1〜2秒以上）、User-Agentの明示、必要に応じたキャッシュを入れる。  
- **運用**  
  サイト構造変更で取得できなくなるリスクがあるため、重要な判断は「ツール結果＋手動確認」の二段構えにしておく。

---

## 4. 次のステップ案

1. **規約確認**（→ 実施済みの整理は [terms-check.md](./terms-check.md) 参照）  
   - SUUMO: 私的利用・軽負荷に留めれば許容の余地あり。at home: **クローラー等による情報取得を明示禁止**のため対象外推奨。HOME'S: 明示的禁止はないが妨害・営利・第三者提供に当たりうる。REINS: 規約の所在・内容は要確認。
2. **プロトタイプの対象を1サイトに限定**  
   - 規約リスクを考慮し、**SUUMO を第一候補**とする。at home はスクレイピング対象から外す。まずは SUUMO で上記一次フィルタ項目を取得する最小スクリプトを作り、出力形式（CSV/JSON）と項目を固める。
3. **判定フローとの接続**  
   - 出力を「候補20件リスト」として使う手順を、条件ドキュメントの判定フローに追記する。
4. **REINSの扱いを確定**  
   - 規約確認後、自動取得するか、手動検索用の入力リスト機能に留めるかを決める。

---

## 5. まとめ

| 質問 | 回答 |
|------|------|
| **条件を満たす物件を“探す”スクレイピングツールは実装可能か？** | **はい。** ただし「条件のすべて」を自動判定するのではなく、**駅徒歩・築年・専有・間取り・戸数・価格**など、物件サイトに載っている項目で一次フィルタし、「候補20件」を効率的に出すツールとして実装可能。 |
| **どこまで自動化し、どこで手動にするか？** | **自動化**：一次フィルタ（上記項目）での物件候補の収集とリスト化。**手動のまま**：管理書類による絞り込み、REINSでの成約確認、内見。REINSは規約次第で補助的に自動取得することは可能。 |
| **フォルダ整理後の役割** | `docs/` に条件・相談メモを置き、`scraping-tool/` で「一次フィルタ用スクレイピング」の設計・実装・運用メモをまとめる構成で、実装可能性とスコープを両立できる。 |

以上を踏まえ、**「一次フィルタ用の物件スクレイピングツール」は実装可能**であり、条件ドキュメントの判定フローの第1ステップを効率化する目的で進めることが妥当と判断できる。
